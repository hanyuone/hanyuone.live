<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1"><!><link rel="modulepreload" href="/staging/28/pkg/website.js" crossorigin="eW494yjK-Cb6dt8cc-nHUg"><link rel="preload" href="/staging/28/pkg/website.wasm" as="fetch" type="application/wasm" crossorigin="eW494yjK-Cb6dt8cc-nHUg"><script type="module" nonce="eW494yjK-Cb6dt8cc-nHUg">(function (root, pkg_path, output_name, wasm_output_name) {
	import(`${root}/${pkg_path}/${output_name}.js`)
		.then(mod => {
			mod.default({module_or_path: `${root}/${pkg_path}/${wasm_output_name}.wasm`}).then(() => {
				mod.hydrate();
			});
		})
})
("/staging/28", "pkg", "website", "website");</script><!--HEAD--><link id="leptos" rel="stylesheet" href="/staging/28/pkg/website.css"><title>Welcome to Leptos</title></head><body><div class="bg-black text-white flex flex-col min-h-screen justify-between"><nav><div class="hidden md:flex flex-row mx-4 border-b border-white"><div class="flex"><a href="/" class="px-4 py-4 font-mono hover:bg-gray transition-colors">hanyuone.live</a></div><div class="flex px-4"><a href="/blog" class="px-4 py-4 text-white hover:bg-blue transition-colors">Blog</a><a href="/public/resume.pdf" class="px-4 py-4 text-white hover:bg-blue transition-colors">Resume</a></div><div class="flex px-4 py-4 ml-auto items-center"><a href="https://github.com/hanyuone" class="px-2 text-neutral-200 hover:text-purple transition-colors"><svg width="1em" height="1.1em" viewBox="0 0 16 16" fill="currentColor" role="graphics-symbol"><g><path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27s1.36.09 2 .27c1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.01 8.01 0 0 0 16 8c0-4.42-3.58-8-8-8" /></g></svg></a><a href="https://linkedin.com/in/hanyuan-li" class="px-2 text-neutral-200 hover:text-blue transition-colors"><svg width="1em" height="1.1em" viewBox="0 0 16 16" fill="currentColor" role="graphics-symbol"><g><path d="M0 1.146C0 .513.526 0 1.175 0h13.65C15.474 0 16 .513 16 1.146v13.708c0 .633-.526 1.146-1.175 1.146H1.175C.526 16 0 15.487 0 14.854zm4.943 12.248V6.169H2.542v7.225zm-1.2-8.212c.837 0 1.358-.554 1.358-1.248-.015-.709-.52-1.248-1.342-1.248S2.4 3.226 2.4 3.934c0 .694.521 1.248 1.327 1.248zm4.908 8.212V9.359c0-.216.016-.432.08-.586.173-.431.568-.878 1.232-.878.869 0 1.216.662 1.216 1.634v3.865h2.401V9.25c0-2.22-1.184-3.252-2.764-3.252-1.274 0-1.845.7-2.165 1.193v.025h-.016l.016-.025V6.169h-2.4c.03.678 0 7.225 0 7.225z" /></g></svg></a><a href="mailto:work@hanyuone.live" class="px-2 text-neutral-200 hover:text-yellow transition-colors"><svg width="1em" height="1.1em" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" stroke="currentColor" fill="none" role="graphics-symbol"><g><path d="m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7" />
<rect x="2" y="4" width="20" height="16" rx="2" /></g></svg></a></div></div></nav><main class="grow p-20"><h4>comments_system_part_1</h4><article class="prose dark:prose-invert"><p>[Element((tag:P,attributes:[],children:[Text("This website has been my passion project, on and off, for the past year or so. Most of the effort"),Text("\n"),Text("has been spent on the blog, and most of the effort of "),Element((tag:Em,attributes:[],children:[Text("that")])),Text(" is on the custom Markdown parser (which"),Text("\n"),Text("actually supports more features, at this point, than GitHub-flavoured Markdown). It"),Text("’"),Text("s become a nice"),Text("\n"),Text("and functional place to put my writing in, but there is still work to be done before it reaches version"),Text("\n"),Text("1.0, a goal of mine for 2025.")])),Element((tag:P,attributes:[],children:[Text("Ultimately, I want this website to be my little corner of the internet. And in this corner, I want a place"),Text("\n"),Text("for friends (and eventually strangers) to leave their thoughts on"),Text("…"),Text(" my thoughts on my blog.")])),Element((tag:P,attributes:[],children:[Text("Thus, I need to make a comments system. And this series of devlogs will serve as a journal on my"),Text("\n"),Text("implementation journey.")])),Element((tag:H3,attributes:[],children:[Text("Picking a service")])),Element((tag:P,attributes:[],children:[Text("The first thought in my head, which goes against everything a software developer stands for, was to not"),Text("\n"),Text("reinvent the wheel. To start with, to make a comments system, I need a database to store all the comments in,"),Text("\n"),Text("an accounts system, an authorisation system for those accounts, a spam filter, notifications"),Text("…"),Text(" and wow,"),Text("\n"),Text("that"),Text("’"),Text("s a "),Element((tag:Em,attributes:[],children:[Text("lot")])),Text(". Many, "),Element((tag:Em,attributes:[],children:[Text("many")])),Text(" people looked into this before me - why not piggyback off the effort of some"),Text("\n"),Text("poor soul that already had to deal with these headaches?")])),Element((tag:P,attributes:[],children:[Text("Getting costs to an absolute minimum were a top priority, as I am but a broke university student. Thus,"),Text("\n"),Text("anything proprietary was off the table, and any external hosting options were too. I managed to find some"),Text("\n"),Text("great open-source tools that look easy to set up - all of the ones below simply work(TM) with Docker:")])),Element((tag:Ul,attributes:[],children:[Element((tag:Li,attributes:[],children:[Element((tag:A,attributes:[(key:Title,value:""),(key:Href,value:"https://github.com/discourse/discourse")],children:[Text("Discourse")]))])),Element((tag:Li,attributes:[],children:[Element((tag:A,attributes:[(key:Title,value:""),(key:Href,value:"https://github.com/adtac/commento")],children:[Text("Commento")]))])),Element((tag:Li,attributes:[],children:[Element((tag:A,attributes:[(key:Title,value:""),(key:Href,value:"https://github.com/isso-comments/isso")],children:[Text("Isso")]))]))])),Element((tag:P,attributes:[],children:[Text("My website itself is hosted on Cloudflare, and so I thought it would be easy to just plop a Docker container"),Text("\n"),Text("on CF and call it a day. Cloudflare itself has a product, known as Containers, which allows me to do exactly"),Text("\n"),Text("that. Let"),Text("’"),Text("s take a deeper look into how Containers works, and"),Text("…")])),Element((tag:Figure,attributes:[(key:Id,value:""),(key:Title,value:"")],children:[Element((tag:Img,attributes:[(key:Src,value:"/public/blog_media/comments_system/containers.png"),(key:Alt,value:"Wait… what’s that bit highlighted in blue?")],children:[])),Element((tag:FigCaption,attributes:[],children:[Text("Wait… what’s that bit highlighted in blue?")]))])),Element((tag:P,attributes:[],children:[])),Element((tag:Figure,attributes:[(key:Id,value:""),(key:Title,value:"")],children:[Element((tag:Img,attributes:[(key:Src,value:"/public/blog_media/comments_system/workers_paid.png"),(key:Alt,value:"Oh…")],children:[])),Element((tag:FigCaption,attributes:[],children:[Text("Oh…")]))])),Element((tag:P,attributes:[],children:[])),Element((tag:P,attributes:[],children:[Text("Change of plans - we have to roll our own comments system. Time to reinvent the wheel.")])),Element((tag:H3,attributes:[],children:[Text("Rolling our own service")])),Element((tag:P,attributes:[],children:[Text("The great thing is, it seems that Cloudflare was one step ahead of us, and has provided us with two"),Text("\n"),Text("tutorials - one for "),Element((tag:A,attributes:[(key:Title,value:""),(key:Href,value:"https://developers.cloudflare.com/d1/tutorials/build-a-comments-api/")],children:[Text("building a comments API")])),Text("\n"),Text("and one for "),Element((tag:A,attributes:[(key:Title,value:""),(key:Href,value:"https://developers.cloudflare.com/workers/languages/rust/")],children:[Text("writing Workers in Rust")])),Text(". Let"),Text("’"),Text("s"),Text("\n"),Text("go ahead and start work on making a comments service in Rust!")])),Element((tag:P,attributes:[],children:[Text("The MVP for such a service, and thus the first thing I"),Text("’"),Text("m working towards, would allow users to login in some way"),Text("\n"),Text("and add comments. All the extra features can come later. To do that, I need to first create an accounts system,"),Text("\n"),Text("but I want it to be secure. I don"),Text("’"),Text("t know much about security, so there is a high risk of something messing up -"),Text("\n"),Text("passwords not being encrypted enough, databases getting breached. The same advice for doing the entire comments"),Text("\n"),Text("system applies here too - why worry about this myself when I can use what other people have already made?")])),Element((tag:P,attributes:[],children:[Text("Luckily for me, there is already an industry standard, "),Element((tag:A,attributes:[(key:Title,value:""),(key:Href,value:"https://oauth.net/2/")],children:[Text("OAuth")])),Text(" - by following the user flows"),Text("\n"),Text("that OAuth says to implement, I can just get users to "),Text("“"),Text("sign in via GitHub"),Text("”"),Text(" or Google, because they provide OAuth"),Text("\n"),Text("integration, and have those platforms handle security for me. Those platforms have millions, or billions, of users,"),Text("\n"),Text("and have entire teams dedicated to making sure their databases are secure, their passwords never get deciphered."),Text("\n"),Text("Furthermore, if I implement the OAuth flow for one platform (GitHub), then it can be pretty easily extended to"),Text("\n"),Text("other big platforms too (Google, Meta"),Text("…"),Text("), since they all follow the standard.")])),Element((tag:P,attributes:[],children:[Text("The implementation started easily enough - I followed both tutorials, I set up some API testing using"),Text("\n"),Element((tag:A,attributes:[(key:Title,value:""),(key:Href,value:"https://insomnia.rest/")],children:[Text("Insomnia")])),Text(", I found a Rust crate that handles all the OAuth stuff for me,"),Text("\n"),Element((tag:A,attributes:[(key:Title,value:""),(key:Href,value:"https://github.com/ramosbugs/oauth2-rs")],children:[Element((tag:Code,attributes:[],children:[Text("oauth2-rs")]))])),Text(". The package even supports popular Rust HTTP clients, like"),Text("\n"),Element((tag:Code,attributes:[],children:[Text("reqwest")])),Text(" and "),Element((tag:Code,attributes:[],children:[Text("ureq")])),Text("! So I started following the example project in "),Element((tag:Code,attributes:[],children:[Text("oauth2-rs")])),Text(", used "),Element((tag:Code,attributes:[],children:[Text("reqwest")])),Text(" for my client,"),Text("\n"),Text("and"),Text("…")])),Element((tag:H3,attributes:[],children:[Text("Rust and WASM")])),Element((tag:P,attributes:[],children:[Element((tag:A,attributes:[(key:Title,value:""),(key:Href,value:"https://webassembly.org/")],children:[Text("WebAssembly")])),Text(", or WASM, is a very new technology, designed to eventually allow"),Text("\n"),Text("programming languages other than JavaScript to work on browsers. It"),Text("’"),Text("s the reason why I can write my entire"),Text("\n"),Text("website in Rust to begin with, and thank goodness for that, because I"),Text("’"),Text("m having a blast not spending my time"),Text("\n"),Text("on JavaScript or TypeScript.")])),Element((tag:P,attributes:[],children:[Text("However, this means that the Rust/WASM ecosystem is very new, and thus subject to a lot of changes and"),Text("\n"),Text("unimplemented/broken things. Take for example the "),Element((tag:Code,attributes:[],children:[Text("rustwasm")])),Text(" organisation, which worked officially within"),Text("\n"),Text("the Rust organisation and maintained a lot of fundamental tools like "),Element((tag:Code,attributes:[],children:[Text("wasm-bindgen")])),Text(" and "),Element((tag:Code,attributes:[],children:[Text("gloo")])),Text(". This group"),Text("\n"),Text("was officially sunset "),Element((tag:A,attributes:[(key:Title,value:""),(key:Href,value:"https://blog.rust-lang.org/inside-rust/2025/07/21/sunsetting-the-rustwasm-github-org/")],children:[Text("in July")])),Text(","),Text("\n"),Text("and the tools under its purview were given to new owners.")])),Element((tag:P,attributes:[],children:[Text("And it"),Text("’"),Text("s not necessarily the fault of the people on the Rust side either, who are doing the lord"),Text("’"),Text("s work."),Text("\n"),Text("The surrounding ecosystem is extremely new (read: unstable) as well - the first big issue I ran into was"),Text("\n"),Text("trying to get "),Element((tag:Code,attributes:[],children:[Text("reqwest")])),Text(" working with the OAuth flow. CF workers are required to use WASM, but "),Element((tag:Code,attributes:[],children:[Text("oauth2-rs")])),Text("\n"),Text("and "),Element((tag:Code,attributes:[],children:[Text("reqwest")])),Text(" were not initially built for WASM, and thus some functionality is not truly cross-platform.")])),Element((tag:P,attributes:[],children:[Text("With GitHub OAuth specifically, I have to get the user to redirect to GitHub"),Text("’"),Text("s login page, which then"),Text("\n"),Text("returns a token that allows us to have permission to access that user"),Text("’"),Text("s profile information (usernames,"),Text("\n"),Text("profile photos). But the OAuth call requires "),Element((tag:Em,attributes:[],children:[Text("manual")])),Text(" redirecting to prevent vulnerabilities such as"),Text("\n"),Element((tag:A,attributes:[(key:Title,value:""),(key:Href,value:"https://portswigger.net/web-security/ssrf")],children:[Text("server-side request forgery")])),Text(" - this is unsupported in "),Element((tag:Code,attributes:[],children:[Text("reqwest")])),Text("\n"),Text("for WASM, because the "),Element((tag:Code,attributes:[],children:[Text("fetch")])),Text(" API (which browsers use to make HTTP requests) is inconsistent (see "),Element((tag:A,attributes:[(key:Title,value:""),(key:Href,value:"https://github.com/seanmonstar/reqwest/pull/2119")],children:[Text("this PR")])),Text("\n"),Text("for more details). Unfortunately, this is something that is completely outside "),Element((tag:Code,attributes:[],children:[Text("reqwest")])),Text("’"),Text("s control, and"),Text("\n"),Text("is obviously not their fault.")])),Element((tag:P,attributes:[],children:[Text("Thus, "),Element((tag:Code,attributes:[],children:[Text("reqwest")])),Text(" is unusable, and a similar tale of the "),Text("“"),Text("wild west"),Text("”"),Text(" of Rust/WASM applied to "),Element((tag:Code,attributes:[],children:[Text("ureq")])),Text(" (the newest"),Text("\n"),Text("version is simply unsupported by "),Element((tag:Code,attributes:[],children:[Text("oauth2-rs")])),Text("). The problem eventually did end up being solved - I used"),Text("\n"),Text("the request API provided by CloudFlare instead - but it was a solid two weeks of digging through GitHub"),Text("\n"),Text("issues and low-level source code that I can"),Text("’"),Text("t get back.")])),Element((tag:H3,attributes:[],children:[Text("Takeaways")])),Element((tag:P,attributes:[],children:[Text("In 2025, the Rust and WASM ecosystem is still being actively worked on, which means that creating whole"),Text("\n"),Text("services and websites on WASM is not exactly the smoothest experience in the world, "),Element((tag:Em,attributes:[],children:[Text("yet")])),Text(". The keyword is"),Text("\n"),Text("“"),Text("yet"),Text("”"),Text(" - the open source community is always amazing, and I"),Text("’"),Text("m still able to write Rust code seamlessly for both"),Text("\n"),Text("my machine and the browser.")])),Element((tag:P,attributes:[],children:[Text("If you care about the very niche issue of having OAuth work properly for WASM, you can track (or help fix!)"),Text("\n"),Text("some of the following issues/PRs:")])),Element((tag:Ul,attributes:[],children:[Element((tag:Li,attributes:[],children:[Element((tag:A,attributes:[(key:Title,value:""),(key:Href,value:"https://github.com/seanmonstar/reqwest/issues/2071")],children:[Text("The redirects issue for WASM "),Element((tag:Code,attributes:[],children:[Text("reqwest")]))]))])),Element((tag:Li,attributes:[],children:[Element((tag:A,attributes:[(key:Title,value:""),(key:Href,value:"https://github.com/ramosbugs/oauth2-rs/pull/324")],children:[Element((tag:Code,attributes:[],children:[Text("oauth2-rs")])),Text(" support for "),Element((tag:Code,attributes:[],children:[Text("ureq")])),Text(" v0.3")]))]))])),Element((tag:P,attributes:[],children:[Text("Join me in the next devlog, where I"),Text("’"),Text("ll focus on integrating the comments system into "),Element((tag:Code,attributes:[],children:[Text("hanyuone.live")])),Text(" itself!")]))]</p></article></main><footer class="mx-4 border-t"><div class="flex flex-row px-4 py-4"><div class="flex"><p>Made with ​</p><p class="text-red">&lt;3</p><p> ​in 2024-25</p></div></div></footer></div></body></html><script nonce="eW494yjK-Cb6dt8cc-nHUg">__RESOLVED_RESOURCES=[];__SERIALIZED_ERRORS=[];__PENDING_RESOURCES=[0,];__RESOURCE_RESOLVERS=[];</script><script nonce="eW494yjK-Cb6dt8cc-nHUg">__RESOLVED_RESOURCES[0] = "{\"Ok\":\"[Element((tag:P,attributes:[],children:[Text(\\\"This website has been my passion project, on and off, for the past year or so. Most of the effort\\\"),Text(\\\"\\\\n\\\"),Text(\\\"has been spent on the blog, and most of the effort of \\\"),Element((tag:Em,attributes:[],children:[Text(\\\"that\\\")])),Text(\\\" is on the custom Markdown parser (which\\\"),Text(\\\"\\\\n\\\"),Text(\\\"actually supports more features, at this point, than GitHub-flavoured Markdown). It\\\"),Text(\\\"’\\\"),Text(\\\"s become a nice\\\"),Text(\\\"\\\\n\\\"),Text(\\\"and functional place to put my writing in, but there is still work to be done before it reaches version\\\"),Text(\\\"\\\\n\\\"),Text(\\\"1.0, a goal of mine for 2025.\\\")])),Element((tag:P,attributes:[],children:[Text(\\\"Ultimately, I want this website to be my little corner of the internet. And in this corner, I want a place\\\"),Text(\\\"\\\\n\\\"),Text(\\\"for friends (and eventually strangers) to leave their thoughts on\\\"),Text(\\\"…\\\"),Text(\\\" my thoughts on my blog.\\\")])),Element((tag:P,attributes:[],children:[Text(\\\"Thus, I need to make a comments system. And this series of devlogs will serve as a journal on my\\\"),Text(\\\"\\\\n\\\"),Text(\\\"implementation journey.\\\")])),Element((tag:H3,attributes:[],children:[Text(\\\"Picking a service\\\")])),Element((tag:P,attributes:[],children:[Text(\\\"The first thought in my head, which goes against everything a software developer stands for, was to not\\\"),Text(\\\"\\\\n\\\"),Text(\\\"reinvent the wheel. To start with, to make a comments system, I need a database to store all the comments in,\\\"),Text(\\\"\\\\n\\\"),Text(\\\"an accounts system, an authorisation system for those accounts, a spam filter, notifications\\\"),Text(\\\"…\\\"),Text(\\\" and wow,\\\"),Text(\\\"\\\\n\\\"),Text(\\\"that\\\"),Text(\\\"’\\\"),Text(\\\"s a \\\"),Element((tag:Em,attributes:[],children:[Text(\\\"lot\\\")])),Text(\\\". Many, \\\"),Element((tag:Em,attributes:[],children:[Text(\\\"many\\\")])),Text(\\\" people looked into this before me - why not piggyback off the effort of some\\\"),Text(\\\"\\\\n\\\"),Text(\\\"poor soul that already had to deal with these headaches?\\\")])),Element((tag:P,attributes:[],children:[Text(\\\"Getting costs to an absolute minimum were a top priority, as I am but a broke university student. Thus,\\\"),Text(\\\"\\\\n\\\"),Text(\\\"anything proprietary was off the table, and any external hosting options were too. I managed to find some\\\"),Text(\\\"\\\\n\\\"),Text(\\\"great open-source tools that look easy to set up - all of the ones below simply work(TM) with Docker:\\\")])),Element((tag:Ul,attributes:[],children:[Element((tag:Li,attributes:[],children:[Element((tag:A,attributes:[(key:Title,value:\\\"\\\"),(key:Href,value:\\\"https://github.com/discourse/discourse\\\")],children:[Text(\\\"Discourse\\\")]))])),Element((tag:Li,attributes:[],children:[Element((tag:A,attributes:[(key:Title,value:\\\"\\\"),(key:Href,value:\\\"https://github.com/adtac/commento\\\")],children:[Text(\\\"Commento\\\")]))])),Element((tag:Li,attributes:[],children:[Element((tag:A,attributes:[(key:Title,value:\\\"\\\"),(key:Href,value:\\\"https://github.com/isso-comments/isso\\\")],children:[Text(\\\"Isso\\\")]))]))])),Element((tag:P,attributes:[],children:[Text(\\\"My website itself is hosted on Cloudflare, and so I thought it would be easy to just plop a Docker container\\\"),Text(\\\"\\\\n\\\"),Text(\\\"on CF and call it a day. Cloudflare itself has a product, known as Containers, which allows me to do exactly\\\"),Text(\\\"\\\\n\\\"),Text(\\\"that. Let\\\"),Text(\\\"’\\\"),Text(\\\"s take a deeper look into how Containers works, and\\\"),Text(\\\"…\\\")])),Element((tag:Figure,attributes:[(key:Id,value:\\\"\\\"),(key:Title,value:\\\"\\\")],children:[Element((tag:Img,attributes:[(key:Src,value:\\\"/public/blog_media/comments_system/containers.png\\\"),(key:Alt,value:\\\"Wait… what’s that bit highlighted in blue?\\\")],children:[])),Element((tag:FigCaption,attributes:[],children:[Text(\\\"Wait… what’s that bit highlighted in blue?\\\")]))])),Element((tag:P,attributes:[],children:[])),Element((tag:Figure,attributes:[(key:Id,value:\\\"\\\"),(key:Title,value:\\\"\\\")],children:[Element((tag:Img,attributes:[(key:Src,value:\\\"/public/blog_media/comments_system/workers_paid.png\\\"),(key:Alt,value:\\\"Oh…\\\")],children:[])),Element((tag:FigCaption,attributes:[],children:[Text(\\\"Oh…\\\")]))])),Element((tag:P,attributes:[],children:[])),Element((tag:P,attributes:[],children:[Text(\\\"Change of plans - we have to roll our own comments system. Time to reinvent the wheel.\\\")])),Element((tag:H3,attributes:[],children:[Text(\\\"Rolling our own service\\\")])),Element((tag:P,attributes:[],children:[Text(\\\"The great thing is, it seems that Cloudflare was one step ahead of us, and has provided us with two\\\"),Text(\\\"\\\\n\\\"),Text(\\\"tutorials - one for \\\"),Element((tag:A,attributes:[(key:Title,value:\\\"\\\"),(key:Href,value:\\\"https://developers.cloudflare.com/d1/tutorials/build-a-comments-api/\\\")],children:[Text(\\\"building a comments API\\\")])),Text(\\\"\\\\n\\\"),Text(\\\"and one for \\\"),Element((tag:A,attributes:[(key:Title,value:\\\"\\\"),(key:Href,value:\\\"https://developers.cloudflare.com/workers/languages/rust/\\\")],children:[Text(\\\"writing Workers in Rust\\\")])),Text(\\\". Let\\\"),Text(\\\"’\\\"),Text(\\\"s\\\"),Text(\\\"\\\\n\\\"),Text(\\\"go ahead and start work on making a comments service in Rust!\\\")])),Element((tag:P,attributes:[],children:[Text(\\\"The MVP for such a service, and thus the first thing I\\\"),Text(\\\"’\\\"),Text(\\\"m working towards, would allow users to login in some way\\\"),Text(\\\"\\\\n\\\"),Text(\\\"and add comments. All the extra features can come later. To do that, I need to first create an accounts system,\\\"),Text(\\\"\\\\n\\\"),Text(\\\"but I want it to be secure. I don\\\"),Text(\\\"’\\\"),Text(\\\"t know much about security, so there is a high risk of something messing up -\\\"),Text(\\\"\\\\n\\\"),Text(\\\"passwords not being encrypted enough, databases getting breached. The same advice for doing the entire comments\\\"),Text(\\\"\\\\n\\\"),Text(\\\"system applies here too - why worry about this myself when I can use what other people have already made?\\\")])),Element((tag:P,attributes:[],children:[Text(\\\"Luckily for me, there is already an industry standard, \\\"),Element((tag:A,attributes:[(key:Title,value:\\\"\\\"),(key:Href,value:\\\"https://oauth.net/2/\\\")],children:[Text(\\\"OAuth\\\")])),Text(\\\" - by following the user flows\\\"),Text(\\\"\\\\n\\\"),Text(\\\"that OAuth says to implement, I can just get users to \\\"),Text(\\\"“\\\"),Text(\\\"sign in via GitHub\\\"),Text(\\\"”\\\"),Text(\\\" or Google, because they provide OAuth\\\"),Text(\\\"\\\\n\\\"),Text(\\\"integration, and have those platforms handle security for me. Those platforms have millions, or billions, of users,\\\"),Text(\\\"\\\\n\\\"),Text(\\\"and have entire teams dedicated to making sure their databases are secure, their passwords never get deciphered.\\\"),Text(\\\"\\\\n\\\"),Text(\\\"Furthermore, if I implement the OAuth flow for one platform (GitHub), then it can be pretty easily extended to\\\"),Text(\\\"\\\\n\\\"),Text(\\\"other big platforms too (Google, Meta\\\"),Text(\\\"…\\\"),Text(\\\"), since they all follow the standard.\\\")])),Element((tag:P,attributes:[],children:[Text(\\\"The implementation started easily enough - I followed both tutorials, I set up some API testing using\\\"),Text(\\\"\\\\n\\\"),Element((tag:A,attributes:[(key:Title,value:\\\"\\\"),(key:Href,value:\\\"https://insomnia.rest/\\\")],children:[Text(\\\"Insomnia\\\")])),Text(\\\", I found a Rust crate that handles all the OAuth stuff for me,\\\"),Text(\\\"\\\\n\\\"),Element((tag:A,attributes:[(key:Title,value:\\\"\\\"),(key:Href,value:\\\"https://github.com/ramosbugs/oauth2-rs\\\")],children:[Element((tag:Code,attributes:[],children:[Text(\\\"oauth2-rs\\\")]))])),Text(\\\". The package even supports popular Rust HTTP clients, like\\\"),Text(\\\"\\\\n\\\"),Element((tag:Code,attributes:[],children:[Text(\\\"reqwest\\\")])),Text(\\\" and \\\"),Element((tag:Code,attributes:[],children:[Text(\\\"ureq\\\")])),Text(\\\"! So I started following the example project in \\\"),Element((tag:Code,attributes:[],children:[Text(\\\"oauth2-rs\\\")])),Text(\\\", used \\\"),Element((tag:Code,attributes:[],children:[Text(\\\"reqwest\\\")])),Text(\\\" for my client,\\\"),Text(\\\"\\\\n\\\"),Text(\\\"and\\\"),Text(\\\"…\\\")])),Element((tag:H3,attributes:[],children:[Text(\\\"Rust and WASM\\\")])),Element((tag:P,attributes:[],children:[Element((tag:A,attributes:[(key:Title,value:\\\"\\\"),(key:Href,value:\\\"https://webassembly.org/\\\")],children:[Text(\\\"WebAssembly\\\")])),Text(\\\", or WASM, is a very new technology, designed to eventually allow\\\"),Text(\\\"\\\\n\\\"),Text(\\\"programming languages other than JavaScript to work on browsers. It\\\"),Text(\\\"’\\\"),Text(\\\"s the reason why I can write my entire\\\"),Text(\\\"\\\\n\\\"),Text(\\\"website in Rust to begin with, and thank goodness for that, because I\\\"),Text(\\\"’\\\"),Text(\\\"m having a blast not spending my time\\\"),Text(\\\"\\\\n\\\"),Text(\\\"on JavaScript or TypeScript.\\\")])),Element((tag:P,attributes:[],children:[Text(\\\"However, this means that the Rust/WASM ecosystem is very new, and thus subject to a lot of changes and\\\"),Text(\\\"\\\\n\\\"),Text(\\\"unimplemented/broken things. Take for example the \\\"),Element((tag:Code,attributes:[],children:[Text(\\\"rustwasm\\\")])),Text(\\\" organisation, which worked officially within\\\"),Text(\\\"\\\\n\\\"),Text(\\\"the Rust organisation and maintained a lot of fundamental tools like \\\"),Element((tag:Code,attributes:[],children:[Text(\\\"wasm-bindgen\\\")])),Text(\\\" and \\\"),Element((tag:Code,attributes:[],children:[Text(\\\"gloo\\\")])),Text(\\\". This group\\\"),Text(\\\"\\\\n\\\"),Text(\\\"was officially sunset \\\"),Element((tag:A,attributes:[(key:Title,value:\\\"\\\"),(key:Href,value:\\\"https://blog.rust-lang.org/inside-rust/2025/07/21/sunsetting-the-rustwasm-github-org/\\\")],children:[Text(\\\"in July\\\")])),Text(\\\",\\\"),Text(\\\"\\\\n\\\"),Text(\\\"and the tools under its purview were given to new owners.\\\")])),Element((tag:P,attributes:[],children:[Text(\\\"And it\\\"),Text(\\\"’\\\"),Text(\\\"s not necessarily the fault of the people on the Rust side either, who are doing the lord\\\"),Text(\\\"’\\\"),Text(\\\"s work.\\\"),Text(\\\"\\\\n\\\"),Text(\\\"The surrounding ecosystem is extremely new (read: unstable) as well - the first big issue I ran into was\\\"),Text(\\\"\\\\n\\\"),Text(\\\"trying to get \\\"),Element((tag:Code,attributes:[],children:[Text(\\\"reqwest\\\")])),Text(\\\" working with the OAuth flow. CF workers are required to use WASM, but \\\"),Element((tag:Code,attributes:[],children:[Text(\\\"oauth2-rs\\\")])),Text(\\\"\\\\n\\\"),Text(\\\"and \\\"),Element((tag:Code,attributes:[],children:[Text(\\\"reqwest\\\")])),Text(\\\" were not initially built for WASM, and thus some functionality is not truly cross-platform.\\\")])),Element((tag:P,attributes:[],children:[Text(\\\"With GitHub OAuth specifically, I have to get the user to redirect to GitHub\\\"),Text(\\\"’\\\"),Text(\\\"s login page, which then\\\"),Text(\\\"\\\\n\\\"),Text(\\\"returns a token that allows us to have permission to access that user\\\"),Text(\\\"’\\\"),Text(\\\"s profile information (usernames,\\\"),Text(\\\"\\\\n\\\"),Text(\\\"profile photos). But the OAuth call requires \\\"),Element((tag:Em,attributes:[],children:[Text(\\\"manual\\\")])),Text(\\\" redirecting to prevent vulnerabilities such as\\\"),Text(\\\"\\\\n\\\"),Element((tag:A,attributes:[(key:Title,value:\\\"\\\"),(key:Href,value:\\\"https://portswigger.net/web-security/ssrf\\\")],children:[Text(\\\"server-side request forgery\\\")])),Text(\\\" - this is unsupported in \\\"),Element((tag:Code,attributes:[],children:[Text(\\\"reqwest\\\")])),Text(\\\"\\\\n\\\"),Text(\\\"for WASM, because the \\\"),Element((tag:Code,attributes:[],children:[Text(\\\"fetch\\\")])),Text(\\\" API (which browsers use to make HTTP requests) is inconsistent (see \\\"),Element((tag:A,attributes:[(key:Title,value:\\\"\\\"),(key:Href,value:\\\"https://github.com/seanmonstar/reqwest/pull/2119\\\")],children:[Text(\\\"this PR\\\")])),Text(\\\"\\\\n\\\"),Text(\\\"for more details). Unfortunately, this is something that is completely outside \\\"),Element((tag:Code,attributes:[],children:[Text(\\\"reqwest\\\")])),Text(\\\"’\\\"),Text(\\\"s control, and\\\"),Text(\\\"\\\\n\\\"),Text(\\\"is obviously not their fault.\\\")])),Element((tag:P,attributes:[],children:[Text(\\\"Thus, \\\"),Element((tag:Code,attributes:[],children:[Text(\\\"reqwest\\\")])),Text(\\\" is unusable, and a similar tale of the \\\"),Text(\\\"“\\\"),Text(\\\"wild west\\\"),Text(\\\"”\\\"),Text(\\\" of Rust/WASM applied to \\\"),Element((tag:Code,attributes:[],children:[Text(\\\"ureq\\\")])),Text(\\\" (the newest\\\"),Text(\\\"\\\\n\\\"),Text(\\\"version is simply unsupported by \\\"),Element((tag:Code,attributes:[],children:[Text(\\\"oauth2-rs\\\")])),Text(\\\"). The problem eventually did end up being solved - I used\\\"),Text(\\\"\\\\n\\\"),Text(\\\"the request API provided by CloudFlare instead - but it was a solid two weeks of digging through GitHub\\\"),Text(\\\"\\\\n\\\"),Text(\\\"issues and low-level source code that I can\\\"),Text(\\\"’\\\"),Text(\\\"t get back.\\\")])),Element((tag:H3,attributes:[],children:[Text(\\\"Takeaways\\\")])),Element((tag:P,attributes:[],children:[Text(\\\"In 2025, the Rust and WASM ecosystem is still being actively worked on, which means that creating whole\\\"),Text(\\\"\\\\n\\\"),Text(\\\"services and websites on WASM is not exactly the smoothest experience in the world, \\\"),Element((tag:Em,attributes:[],children:[Text(\\\"yet\\\")])),Text(\\\". The keyword is\\\"),Text(\\\"\\\\n\\\"),Text(\\\"“\\\"),Text(\\\"yet\\\"),Text(\\\"”\\\"),Text(\\\" - the open source community is always amazing, and I\\\"),Text(\\\"’\\\"),Text(\\\"m still able to write Rust code seamlessly for both\\\"),Text(\\\"\\\\n\\\"),Text(\\\"my machine and the browser.\\\")])),Element((tag:P,attributes:[],children:[Text(\\\"If you care about the very niche issue of having OAuth work properly for WASM, you can track (or help fix!)\\\"),Text(\\\"\\\\n\\\"),Text(\\\"some of the following issues/PRs:\\\")])),Element((tag:Ul,attributes:[],children:[Element((tag:Li,attributes:[],children:[Element((tag:A,attributes:[(key:Title,value:\\\"\\\"),(key:Href,value:\\\"https://github.com/seanmonstar/reqwest/issues/2071\\\")],children:[Text(\\\"The redirects issue for WASM \\\"),Element((tag:Code,attributes:[],children:[Text(\\\"reqwest\\\")]))]))])),Element((tag:Li,attributes:[],children:[Element((tag:A,attributes:[(key:Title,value:\\\"\\\"),(key:Href,value:\\\"https://github.com/ramosbugs/oauth2-rs/pull/324\\\")],children:[Element((tag:Code,attributes:[],children:[Text(\\\"oauth2-rs\\\")])),Text(\\\" support for \\\"),Element((tag:Code,attributes:[],children:[Text(\\\"ureq\\\")])),Text(\\\" v0.3\\\")]))]))])),Element((tag:P,attributes:[],children:[Text(\\\"Join me in the next devlog, where I\\\"),Text(\\\"’\\\"),Text(\\\"ll focus on integrating the comments system into \\\"),Element((tag:Code,attributes:[],children:[Text(\\\"hanyuone.live\\\")])),Text(\\\" itself!\\\")]))]\"}";</script><script nonce="eW494yjK-Cb6dt8cc-nHUg">__INCOMPLETE_CHUNKS=[];</script>