<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1"><!><link rel="modulepreload" href="/staging/28/pkg/website.js" crossorigin="E5CouHtUasC6QndkGblOrg"><link rel="preload" href="/staging/28/pkg/website.wasm" as="fetch" type="application/wasm" crossorigin="E5CouHtUasC6QndkGblOrg"><script type="module" nonce="E5CouHtUasC6QndkGblOrg">(function (root, pkg_path, output_name, wasm_output_name) {
	import(`${root}/${pkg_path}/${output_name}.js`)
		.then(mod => {
			mod.default({module_or_path: `${root}/${pkg_path}/${wasm_output_name}.wasm`}).then(() => {
				mod.hydrate();
			});
		})
})
("/staging/28", "pkg", "website", "website");</script><!--HEAD--><link id="leptos" rel="stylesheet" href="/staging/28/pkg/website.css"><title>Welcome to Leptos</title></head><body><div class="bg-black text-white flex flex-col min-h-screen justify-between"><nav><div class="hidden md:flex flex-row mx-4 border-b border-white"><div class="flex"><a href="/" class="px-4 py-4 font-mono hover:bg-gray transition-colors">hanyuone.live</a></div><div class="flex px-4"><a href="/blog" class="px-4 py-4 text-white hover:bg-blue transition-colors">Blog</a><a href="/public/resume.pdf" class="px-4 py-4 text-white hover:bg-blue transition-colors">Resume</a></div><div class="flex px-4 py-4 ml-auto items-center"><a href="https://github.com/hanyuone" class="px-2 text-neutral-200 hover:text-purple transition-colors"><svg width="1em" height="1.1em" viewBox="0 0 16 16" fill="currentColor" role="graphics-symbol"><g><path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27s1.36.09 2 .27c1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.01 8.01 0 0 0 16 8c0-4.42-3.58-8-8-8" /></g></svg></a><a href="https://linkedin.com/in/hanyuan-li" class="px-2 text-neutral-200 hover:text-blue transition-colors"><svg width="1em" height="1.1em" viewBox="0 0 16 16" fill="currentColor" role="graphics-symbol"><g><path d="M0 1.146C0 .513.526 0 1.175 0h13.65C15.474 0 16 .513 16 1.146v13.708c0 .633-.526 1.146-1.175 1.146H1.175C.526 16 0 15.487 0 14.854zm4.943 12.248V6.169H2.542v7.225zm-1.2-8.212c.837 0 1.358-.554 1.358-1.248-.015-.709-.52-1.248-1.342-1.248S2.4 3.226 2.4 3.934c0 .694.521 1.248 1.327 1.248zm4.908 8.212V9.359c0-.216.016-.432.08-.586.173-.431.568-.878 1.232-.878.869 0 1.216.662 1.216 1.634v3.865h2.401V9.25c0-2.22-1.184-3.252-2.764-3.252-1.274 0-1.845.7-2.165 1.193v.025h-.016l.016-.025V6.169h-2.4c.03.678 0 7.225 0 7.225z" /></g></svg></a><a href="mailto:work@hanyuone.live" class="px-2 text-neutral-200 hover:text-yellow transition-colors"><svg width="1em" height="1.1em" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" stroke="currentColor" fill="none" role="graphics-symbol"><g><path d="m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7" />
<rect x="2" y="4" width="20" height="16" rx="2" /></g></svg></a></div></div></nav><main class="grow p-20"><h4>ductf_2021_writeup</h4><article class="prose dark:prose-invert"><p>[Callout((kind:Note,children:[Element((tag:P,attributes:[],children:[Text("This is a writeup for the Substitution II "),Element((tag:Code,attributes:[],children:[Text("crypto")])),Text(" problem in the Down Under CTF 2021, which can be found "),Element((tag:A,attributes:[(key:Title,value:""),(key:Href,value:"https://github.com/DownUnderCTF/Challenges_2021_Public/tree/main/crypto/substitution-cipher-ii")],children:[Text("here")])),Text(".")]))])),Element((tag:H1,attributes:[],children:[Text("Substitution Cipher II (100 points)")])),Element((tag:H2,attributes:[],children:[Text("Explanation:")])),Element((tag:P,attributes:[],children:[Text("Here is the Sage code that was provided:")])),Element((tag:Pre,attributes:[],children:[Element((tag:Code,attributes:[],children:[Text("from string import ascii_lowercase, digits\nCHARSET = \"DUCTF{}_!?\'\" + ascii_lowercase + digits\nn = len(CHARSET)\n\ndef encrypt(msg, f):\n    ct = \'\'\n    for c in msg:\n        ct += CHARSET[f.substitute(CHARSET.index(c))]\n    return ct\n\nP.&lt;x&gt; = PolynomialRing(GF(n))\nf = P.random_element(6)\n\nFLAG = open(\'./flag.txt\', \'r\').read().strip()\n\nenc = encrypt(FLAG, f)\nprint(enc)\n")]))])),Element((tag:P,attributes:[],children:[Element((tag:Code,attributes:[],children:[Text("encrypt(msg, f)")])),Text(" is fairly straightforward, it maps each character in our message to another character in "),Element((tag:Code,attributes:[],children:[Text("CHARSET")])),Text(". "),Element((tag:Code,attributes:[],children:[Text("CHARSET")])),Text(" itself consists of "),Element((tag:Code,attributes:[],children:[Text("DUCTF{}_!?")])),Text(", plus all lowercase characters and digits, making up a total of 47 characters.")])),Element((tag:P,attributes:[],children:[Text("The next two lines, however, are very interesting. "),Element((tag:Code,attributes:[],children:[Text("P.&lt;x&gt; = PolynomialRing(GF(n))")])),Text(" defines a Galois field of size 47, otherwise known as "),Element((tag:Code,attributes:[],children:[Text("GF(47)")])),Text(". From Wikipedia (emphasis mine):")])),Element((tag:BlockQuote,attributes:[(key:Class,value:"blockquote")],children:[Element((tag:P,attributes:[],children:[Text("In mathematics, a Galois field is a field that contains a "),Element((tag:Strong,attributes:[],children:[Text("finite number of elements")])),Text(". A Galois field is a set on which the operations of "),Element((tag:Strong,attributes:[],children:[Text("multiplication, addition, subtraction and division are defined")])),Text(" and satisfy certain basic rules. The most common examples of finite fields are given by the "),Element((tag:Strong,attributes:[],children:[Text("integers mod p when p is a prime number")])),Text(".")]))])),Element((tag:P,attributes:[],children:[Text("Because 47 is prime, "),Element((tag:Code,attributes:[],children:[Text("GF(47)")])),Text(" consists of the set of integers "),Element((tag:Code,attributes:[],children:[Text("{0, 1, 2... 46}")])),Text(", where addition, subtraction, multiplication and division are all "),Element((tag:Code,attributes:[],children:[Text("mod 47")])),Text(". Thus, "),Element((tag:Code,attributes:[],children:[Text("6 * 8")])),Text(" in the field of real numbers would be "),Element((tag:Code,attributes:[],children:[Text("48")])),Text(", but in "),Element((tag:Code,attributes:[],children:[Text("GF(47)")])),Text(" it would be "),Element((tag:Code,attributes:[],children:[Text("48 mod 47 = 1")])),Text(".")])),Element((tag:P,attributes:[],children:[Element((tag:Code,attributes:[],children:[Text("f = P.random_element(6)")])),Text(" defines a random polynomial of degree 6 - in other words, "),Element((tag:Code,attributes:[],children:[Text("f = ax^6 + bx^5 + cx^4 + dx^3 + ex^2 + fx + g")])),Text(", where "),Element((tag:Code,attributes:[],children:[Text("a")])),Text(" to "),Element((tag:Code,attributes:[],children:[Text("g")])),Text(" are all integers between 0 and 46 inclusive. Thus, it is our job to figure out those 7 variables in order to reverse-engineer the encryption.")])),Element((tag:P,attributes:[],children:[Text("To solve a system of 7 unknown variables, we need 7 independent equations. Luckily, we know what exactly 7 of the characters in our encrypted flag map to because of the standard flag format!")])),Element((tag:Pre,attributes:[],children:[Element((tag:Code,attributes:[],children:[Text("encrypted: Ujyw5dnFofaou0au3nx3Cn84\nformat:    DUCTF{.................}\n")]))])),Element((tag:P,attributes:[],children:[Text("Because the cipher is one-to-one, "),Element((tag:Code,attributes:[],children:[Text("D")])),Text(" maps to "),Element((tag:Code,attributes:[],children:[Text("U")])),Text(", "),Element((tag:Code,attributes:[],children:[Text("U")])),Text(" maps to "),Element((tag:Code,attributes:[],children:[Text("j")])),Text(", and so on. Based on the indices of these characters in "),Element((tag:Code,attributes:[],children:[Text("CHARSET")])),Text(", we know that "),Element((tag:Code,attributes:[],children:[Text("f(0) = 1")])),Text(", "),Element((tag:Code,attributes:[],children:[Text("f(1) = 20")])),Text("…"),Text(" "),Element((tag:Code,attributes:[],children:[Text("f(6) = 41")])),Text(". We now have our 7 simultaneous equations:")])),Element((tag:P,attributes:[],children:[Element((tag:Script,attributes:[(key:Type,value:"math/tex"),(key:Mode,value:"display")],children:[Text("\n\\begin{align}\n                                 g &amp;=  1, \\\\\n  a +   b +   c +  d +  e +  f + g &amp;= 20, \\\\\n64a + 32b + 16c + 8d + 4e + 2f + g &amp;= 35, \\\\\n&amp;\\cdots\n\\end{align}\n")]))])),Element((tag:P,attributes:[],children:[Text("We can create a matrix representation of these simultaneous equations, and now we need to solve for "),Element((tag:Code,attributes:[],children:[Text("x")])),Text(":")])),Element((tag:P,attributes:[],children:[Element((tag:Script,attributes:[(key:Type,value:"math/tex"),(key:Mode,value:"display")],children:[Text("\n\\begin{bmatrix}\n0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 1 \\\\\n1 &amp; 1 &amp; 1 &amp; 1 &amp; 1 &amp; 1 &amp; 1 \\\\\n64 &amp; 32 &amp; 16 &amp; 8 &amp; 4 &amp; 2 &amp; 1 \\\\\n&amp; &amp; &amp; \\vdots &amp; &amp; &amp;\n\\end{bmatrix}\nx =\n\\begin{bmatrix}\n1 \\\\ 20 \\\\ 35 \\\\ \\vdots\n\\end{bmatrix}\n")]))])),Element((tag:P,attributes:[],children:[Text("Plugging the matrix and column vector into Maple and solving for "),Element((tag:Code,attributes:[],children:[Text("x")])),Text(", "),Element((tag:Code,attributes:[],children:[Text("x")])),Text(" is equal to the column vector "),Element((tag:Code,attributes:[],children:[Text("&lt;37/80, -633/80, 2437/48, -7229/48, 5963/30, -4349/60, 1&gt;")])),Text(", which is equivalent to "),Element((tag:Code,attributes:[],children:[Text("&lt;41, 15, 40, 9, 28, 27, 1&gt;")])),Text(" mod 47.")])),Element((tag:P,attributes:[],children:[Text("Thus, our random polynomial, "),Element((tag:Code,attributes:[],children:[Text("f")])),Text(", is "),Element((tag:Script,attributes:[(key:Type,value:"math/tex")],children:[Text("41x^6 + 15x^5 + 40x^4 + 9x^3 + 28x^2 + 27x + 1")])),Text(".")])),Element((tag:H2,attributes:[],children:[Text("Final solution:")])),Element((tag:Pre,attributes:[],children:[Element((tag:Code,attributes:[],children:[Element((tag:Span,attributes:[(key:Style,value:"color: rgb(180, 142, 173)")],children:[Text("from")])),Element((tag:Span,attributes:[(key:Style,value:"color: rgb(192, 197, 206)")],children:[Text(" string ")])),Element((tag:Span,attributes:[(key:Style,value:"color: rgb(180, 142, 173)")],children:[Text("import")])),Element((tag:Span,attributes:[(key:Style,value:"color: rgb(192, 197, 206)")],children:[Text(" ascii_lowercase, digits")])),Text("\n"),Text("\n"),Element((tag:Span,attributes:[(key:Style,value:"color: rgb(191, 97, 106)")],children:[Text("CHARSET")])),Element((tag:Span,attributes:[(key:Style,value:"color: rgb(192, 197, 206)")],children:[Text(" = \"")])),Element((tag:Span,attributes:[(key:Style,value:"color: rgb(163, 190, 140)")],children:[Text("DUCTF")])),Element((tag:Span,attributes:[(key:Style,value:"color: rgb(208, 135, 112)")],children:[Text("{}")])),Element((tag:Span,attributes:[(key:Style,value:"color: rgb(163, 190, 140)")],children:[Text("_!?\'")])),Element((tag:Span,attributes:[(key:Style,value:"color: rgb(192, 197, 206)")],children:[Text("\" + ascii_lowercase + digits")])),Text("\n"),Element((tag:Span,attributes:[(key:Style,value:"color: rgb(101, 115, 126)")],children:[Text("# Encrypted flag")])),Text("\n"),Element((tag:Span,attributes:[(key:Style,value:"color: rgb(191, 97, 106)")],children:[Text("FLAG")])),Element((tag:Span,attributes:[(key:Style,value:"color: rgb(192, 197, 206)")],children:[Text(" = \"")])),Element((tag:Span,attributes:[(key:Style,value:"color: rgb(163, 190, 140)")],children:[Text("Ujyw5dnFofaou0au3nx3Cn84")])),Element((tag:Span,attributes:[(key:Style,value:"color: rgb(192, 197, 206)")],children:[Text("\"")])),Text("\n"),Text("\n"),Element((tag:Span,attributes:[(key:Style,value:"color: rgb(101, 115, 126)")],children:[Text("# Given a number between 0 and 47, applies the random polynomial in Sage")])),Text("\n"),Element((tag:Span,attributes:[(key:Style,value:"color: rgb(101, 115, 126)")],children:[Text("# to that number mod 47")])),Text("\n"),Element((tag:Span,attributes:[(key:Style,value:"color: rgb(180, 142, 173)")],children:[Text("def")])),Element((tag:Span,attributes:[(key:Style,value:"color: rgb(192, 197, 206)")],children:[Text(" ")])),Element((tag:Span,attributes:[(key:Style,value:"color: rgb(143, 161, 179)")],children:[Text("polynomial_g47")])),Element((tag:Span,attributes:[(key:Style,value:"color: rgb(192, 197, 206)")],children:[Text("(")])),Element((tag:Span,attributes:[(key:Style,value:"color: rgb(191, 97, 106)")],children:[Text("x")])),Element((tag:Span,attributes:[(key:Style,value:"color: rgb(192, 197, 206)")],children:[Text("):")])),Text("\n"),Element((tag:Span,attributes:[(key:Style,value:"color: rgb(192, 197, 206)")],children:[Text("    poly = ")])),Element((tag:Span,attributes:[(key:Style,value:"color: rgb(208, 135, 112)")],children:[Text("41")])),Element((tag:Span,attributes:[(key:Style,value:"color: rgb(192, 197, 206)")],children:[Text(" * x ** ")])),Element((tag:Span,attributes:[(key:Style,value:"color: rgb(208, 135, 112)")],children:[Text("6")])),Element((tag:Span,attributes:[(key:Style,value:"color: rgb(192, 197, 206)")],children:[Text(" + ")])),Element((tag:Span,attributes:[(key:Style,value:"color: rgb(208, 135, 112)")],children:[Text("15")])),Element((tag:Span,attributes:[(key:Style,value:"color: rgb(192, 197, 206)")],children:[Text(" * x ** ")])),Element((tag:Span,attributes:[(key:Style,value:"color: rgb(208, 135, 112)")],children:[Text("5")])),Element((tag:Span,attributes:[(key:Style,value:"color: rgb(192, 197, 206)")],children:[Text(" + ")])),Element((tag:Span,attributes:[(key:Style,value:"color: rgb(208, 135, 112)")],children:[Text("40")])),Element((tag:Span,attributes:[(key:Style,value:"color: rgb(192, 197, 206)")],children:[Text(" * x ** ")])),Element((tag:Span,attributes:[(key:Style,value:"color: rgb(208, 135, 112)")],children:[Text("4")])),Element((tag:Span,attributes:[(key:Style,value:"color: rgb(192, 197, 206)")],children:[Text(" + ")])),Element((tag:Span,attributes:[(key:Style,value:"color: rgb(208, 135, 112)")],children:[Text("9")])),Element((tag:Span,attributes:[(key:Style,value:"color: rgb(192, 197, 206)")],children:[Text(" * x ** ")])),Element((tag:Span,attributes:[(key:Style,value:"color: rgb(208, 135, 112)")],children:[Text("3")])),Element((tag:Span,attributes:[(key:Style,value:"color: rgb(192, 197, 206)")],children:[Text(" + ")])),Element((tag:Span,attributes:[(key:Style,value:"color: rgb(208, 135, 112)")],children:[Text("28")])),Element((tag:Span,attributes:[(key:Style,value:"color: rgb(192, 197, 206)")],children:[Text(" * x ** ")])),Element((tag:Span,attributes:[(key:Style,value:"color: rgb(208, 135, 112)")],children:[Text("2")])),Element((tag:Span,attributes:[(key:Style,value:"color: rgb(192, 197, 206)")],children:[Text(" + ")])),Element((tag:Span,attributes:[(key:Style,value:"color: rgb(208, 135, 112)")],children:[Text("27")])),Element((tag:Span,attributes:[(key:Style,value:"color: rgb(192, 197, 206)")],children:[Text(" * x + ")])),Element((tag:Span,attributes:[(key:Style,value:"color: rgb(208, 135, 112)")],children:[Text("1")])),Text("\n"),Element((tag:Span,attributes:[(key:Style,value:"color: rgb(192, 197, 206)")],children:[Text("    ")])),Element((tag:Span,attributes:[(key:Style,value:"color: rgb(180, 142, 173)")],children:[Text("return")])),Element((tag:Span,attributes:[(key:Style,value:"color: rgb(192, 197, 206)")],children:[Text(" poly % ")])),Element((tag:Span,attributes:[(key:Style,value:"color: rgb(208, 135, 112)")],children:[Text("47")])),Text("\n"),Text("\n"),Element((tag:Span,attributes:[(key:Style,value:"color: rgb(101, 115, 126)")],children:[Text("# Maps each possible input character (D, U, C, T, F and so on) to")])),Text("\n"),Element((tag:Span,attributes:[(key:Style,value:"color: rgb(101, 115, 126)")],children:[Text("# a list of characters it might be translated from, so mapping[1] = \"D\"")])),Text("\n"),Element((tag:Span,attributes:[(key:Style,value:"color: rgb(192, 197, 206)")],children:[Text("mapping = [\"\"] * ")])),Element((tag:Span,attributes:[(key:Style,value:"color: rgb(208, 135, 112)")],children:[Text("47")])),Text("\n"),Element((tag:Span,attributes:[(key:Style,value:"color: rgb(180, 142, 173)")],children:[Text("for")])),Element((tag:Span,attributes:[(key:Style,value:"color: rgb(192, 197, 206)")],children:[Text(" i ")])),Element((tag:Span,attributes:[(key:Style,value:"color: rgb(180, 142, 173)")],children:[Text("in")])),Element((tag:Span,attributes:[(key:Style,value:"color: rgb(192, 197, 206)")],children:[Text(" ")])),Element((tag:Span,attributes:[(key:Style,value:"color: rgb(150, 181, 180)")],children:[Text("range")])),Element((tag:Span,attributes:[(key:Style,value:"color: rgb(192, 197, 206)")],children:[Text("(")])),Element((tag:Span,attributes:[(key:Style,value:"color: rgb(208, 135, 112)")],children:[Text("47")])),Element((tag:Span,attributes:[(key:Style,value:"color: rgb(192, 197, 206)")],children:[Text("):")])),Text("\n"),Element((tag:Span,attributes:[(key:Style,value:"color: rgb(192, 197, 206)")],children:[Text("    mapping[")])),Element((tag:Span,attributes:[(key:Style,value:"color: rgb(143, 161, 179)")],children:[Text("polynomial_g47")])),Element((tag:Span,attributes:[(key:Style,value:"color: rgb(192, 197, 206)")],children:[Text("(i)] += ")])),Element((tag:Span,attributes:[(key:Style,value:"color: rgb(191, 97, 106)")],children:[Text("CHARSET")])),Element((tag:Span,attributes:[(key:Style,value:"color: rgb(192, 197, 206)")],children:[Text("[i]")])),Text("\n"),Text("\n"),Element((tag:Span,attributes:[(key:Style,value:"color: rgb(150, 181, 180)")],children:[Text("print")])),Element((tag:Span,attributes:[(key:Style,value:"color: rgb(192, 197, 206)")],children:[Text("(mapping)")])),Text("\n"),Text("\n"),Element((tag:Span,attributes:[(key:Style,value:"color: rgb(101, 115, 126)")],children:[Text("# Prints out all possible combinations of characters that")])),Text("\n"),Element((tag:Span,attributes:[(key:Style,value:"color: rgb(101, 115, 126)")],children:[Text("# form the encrypted flag")])),Text("\n"),Element((tag:Span,attributes:[(key:Style,value:"color: rgb(192, 197, 206)")],children:[Text("result = \"\"")])),Text("\n"),Element((tag:Span,attributes:[(key:Style,value:"color: rgb(180, 142, 173)")],children:[Text("for")])),Element((tag:Span,attributes:[(key:Style,value:"color: rgb(192, 197, 206)")],children:[Text(" char ")])),Element((tag:Span,attributes:[(key:Style,value:"color: rgb(180, 142, 173)")],children:[Text("in")])),Element((tag:Span,attributes:[(key:Style,value:"color: rgb(192, 197, 206)")],children:[Text(" ")])),Element((tag:Span,attributes:[(key:Style,value:"color: rgb(191, 97, 106)")],children:[Text("FLAG")])),Element((tag:Span,attributes:[(key:Style,value:"color: rgb(192, 197, 206)")],children:[Text(":")])),Text("\n"),Element((tag:Span,attributes:[(key:Style,value:"color: rgb(192, 197, 206)")],children:[Text("    index = CHARSET.")])),Element((tag:Span,attributes:[(key:Style,value:"color: rgb(143, 161, 179)")],children:[Text("index")])),Element((tag:Span,attributes:[(key:Style,value:"color: rgb(192, 197, 206)")],children:[Text("(char)")])),Text("\n"),Element((tag:Span,attributes:[(key:Style,value:"color: rgb(192, 197, 206)")],children:[Text("    current = mapping[index]")])),Text("\n"),Text("\n"),Element((tag:Span,attributes:[(key:Style,value:"color: rgb(192, 197, 206)")],children:[Text("    ")])),Element((tag:Span,attributes:[(key:Style,value:"color: rgb(180, 142, 173)")],children:[Text("if")])),Element((tag:Span,attributes:[(key:Style,value:"color: rgb(192, 197, 206)")],children:[Text(" ")])),Element((tag:Span,attributes:[(key:Style,value:"color: rgb(150, 181, 180)")],children:[Text("len")])),Element((tag:Span,attributes:[(key:Style,value:"color: rgb(192, 197, 206)")],children:[Text("(current) &gt; ")])),Element((tag:Span,attributes:[(key:Style,value:"color: rgb(208, 135, 112)")],children:[Text("1")])),Element((tag:Span,attributes:[(key:Style,value:"color: rgb(192, 197, 206)")],children:[Text(":")])),Text("\n"),Element((tag:Span,attributes:[(key:Style,value:"color: rgb(192, 197, 206)")],children:[Text("        result += ")])),Element((tag:Span,attributes:[(key:Style,value:"color: rgb(180, 142, 173)")],children:[Text("f")])),Element((tag:Span,attributes:[(key:Style,value:"color: rgb(192, 197, 206)")],children:[Text("\"")])),Element((tag:Span,attributes:[(key:Style,value:"color: rgb(163, 190, 140)")],children:[Text("[")])),Element((tag:Span,attributes:[(key:Style,value:"color: rgb(192, 197, 206)")],children:[Text("{current}")])),Element((tag:Span,attributes:[(key:Style,value:"color: rgb(163, 190, 140)")],children:[Text("]")])),Element((tag:Span,attributes:[(key:Style,value:"color: rgb(192, 197, 206)")],children:[Text("\"")])),Text("\n"),Element((tag:Span,attributes:[(key:Style,value:"color: rgb(192, 197, 206)")],children:[Text("    ")])),Element((tag:Span,attributes:[(key:Style,value:"color: rgb(180, 142, 173)")],children:[Text("else")])),Element((tag:Span,attributes:[(key:Style,value:"color: rgb(192, 197, 206)")],children:[Text(":")])),Text("\n"),Element((tag:Span,attributes:[(key:Style,value:"color: rgb(192, 197, 206)")],children:[Text("        result += current")])),Text("\n"),Text("\n"),Element((tag:Span,attributes:[(key:Style,value:"color: rgb(150, 181, 180)")],children:[Text("print")])),Element((tag:Span,attributes:[(key:Style,value:"color: rgb(192, 197, 206)")],children:[Text("(result)")])),Text("\n")]))])),Element((tag:P,attributes:[],children:[Text("Running this program returns the output "),Element((tag:Code,attributes:[],children:[Text("D[U!]C[Tt]F{go0d_0l\'_l4gr4[fnp]g[38]}")])),Text("."),Text("\n"),Text("Choosing the right characters in each square bracket, we get the flag"),Text("\n"),Element((tag:Code,attributes:[],children:[Text("DUCTF{go0d_0l\'_l4gr4ng3}")])),Text(".")]))]</p></article></main><footer class="mx-4 border-t"><div class="flex flex-row px-4 py-4"><div class="flex"><p>Made with ​</p><p class="text-red">&lt;3</p><p> ​in 2024-25</p></div></div></footer></div></body></html><script nonce="E5CouHtUasC6QndkGblOrg">__RESOLVED_RESOURCES=[];__SERIALIZED_ERRORS=[];__PENDING_RESOURCES=[0,];__RESOURCE_RESOLVERS=[];</script><script nonce="E5CouHtUasC6QndkGblOrg">__RESOLVED_RESOURCES[0] = "{\"Ok\":\"[Callout((kind:Note,children:[Element((tag:P,attributes:[],children:[Text(\\\"This is a writeup for the Substitution II \\\"),Element((tag:Code,attributes:[],children:[Text(\\\"crypto\\\")])),Text(\\\" problem in the Down Under CTF 2021, which can be found \\\"),Element((tag:A,attributes:[(key:Title,value:\\\"\\\"),(key:Href,value:\\\"https://github.com/DownUnderCTF/Challenges_2021_Public/tree/main/crypto/substitution-cipher-ii\\\")],children:[Text(\\\"here\\\")])),Text(\\\".\\\")]))])),Element((tag:H1,attributes:[],children:[Text(\\\"Substitution Cipher II (100 points)\\\")])),Element((tag:H2,attributes:[],children:[Text(\\\"Explanation:\\\")])),Element((tag:P,attributes:[],children:[Text(\\\"Here is the Sage code that was provided:\\\")])),Element((tag:Pre,attributes:[],children:[Element((tag:Code,attributes:[],children:[Text(\\\"from string import ascii_lowercase, digits\\\\nCHARSET = \\\\\\\"DUCTF{}_!?\\\\'\\\\\\\" + ascii_lowercase + digits\\\\nn = len(CHARSET)\\\\n\\\\ndef encrypt(msg, f):\\\\n    ct = \\\\'\\\\'\\\\n    for c in msg:\\\\n        ct += CHARSET[f.substitute(CHARSET.index(c))]\\\\n    return ct\\\\n\\\\nP.\\u003cx> = PolynomialRing(GF(n))\\\\nf = P.random_element(6)\\\\n\\\\nFLAG = open(\\\\'./flag.txt\\\\', \\\\'r\\\\').read().strip()\\\\n\\\\nenc = encrypt(FLAG, f)\\\\nprint(enc)\\\\n\\\")]))])),Element((tag:P,attributes:[],children:[Element((tag:Code,attributes:[],children:[Text(\\\"encrypt(msg, f)\\\")])),Text(\\\" is fairly straightforward, it maps each character in our message to another character in \\\"),Element((tag:Code,attributes:[],children:[Text(\\\"CHARSET\\\")])),Text(\\\". \\\"),Element((tag:Code,attributes:[],children:[Text(\\\"CHARSET\\\")])),Text(\\\" itself consists of \\\"),Element((tag:Code,attributes:[],children:[Text(\\\"DUCTF{}_!?\\\")])),Text(\\\", plus all lowercase characters and digits, making up a total of 47 characters.\\\")])),Element((tag:P,attributes:[],children:[Text(\\\"The next two lines, however, are very interesting. \\\"),Element((tag:Code,attributes:[],children:[Text(\\\"P.\\u003cx> = PolynomialRing(GF(n))\\\")])),Text(\\\" defines a Galois field of size 47, otherwise known as \\\"),Element((tag:Code,attributes:[],children:[Text(\\\"GF(47)\\\")])),Text(\\\". From Wikipedia (emphasis mine):\\\")])),Element((tag:BlockQuote,attributes:[(key:Class,value:\\\"blockquote\\\")],children:[Element((tag:P,attributes:[],children:[Text(\\\"In mathematics, a Galois field is a field that contains a \\\"),Element((tag:Strong,attributes:[],children:[Text(\\\"finite number of elements\\\")])),Text(\\\". A Galois field is a set on which the operations of \\\"),Element((tag:Strong,attributes:[],children:[Text(\\\"multiplication, addition, subtraction and division are defined\\\")])),Text(\\\" and satisfy certain basic rules. The most common examples of finite fields are given by the \\\"),Element((tag:Strong,attributes:[],children:[Text(\\\"integers mod p when p is a prime number\\\")])),Text(\\\".\\\")]))])),Element((tag:P,attributes:[],children:[Text(\\\"Because 47 is prime, \\\"),Element((tag:Code,attributes:[],children:[Text(\\\"GF(47)\\\")])),Text(\\\" consists of the set of integers \\\"),Element((tag:Code,attributes:[],children:[Text(\\\"{0, 1, 2... 46}\\\")])),Text(\\\", where addition, subtraction, multiplication and division are all \\\"),Element((tag:Code,attributes:[],children:[Text(\\\"mod 47\\\")])),Text(\\\". Thus, \\\"),Element((tag:Code,attributes:[],children:[Text(\\\"6 * 8\\\")])),Text(\\\" in the field of real numbers would be \\\"),Element((tag:Code,attributes:[],children:[Text(\\\"48\\\")])),Text(\\\", but in \\\"),Element((tag:Code,attributes:[],children:[Text(\\\"GF(47)\\\")])),Text(\\\" it would be \\\"),Element((tag:Code,attributes:[],children:[Text(\\\"48 mod 47 = 1\\\")])),Text(\\\".\\\")])),Element((tag:P,attributes:[],children:[Element((tag:Code,attributes:[],children:[Text(\\\"f = P.random_element(6)\\\")])),Text(\\\" defines a random polynomial of degree 6 - in other words, \\\"),Element((tag:Code,attributes:[],children:[Text(\\\"f = ax^6 + bx^5 + cx^4 + dx^3 + ex^2 + fx + g\\\")])),Text(\\\", where \\\"),Element((tag:Code,attributes:[],children:[Text(\\\"a\\\")])),Text(\\\" to \\\"),Element((tag:Code,attributes:[],children:[Text(\\\"g\\\")])),Text(\\\" are all integers between 0 and 46 inclusive. Thus, it is our job to figure out those 7 variables in order to reverse-engineer the encryption.\\\")])),Element((tag:P,attributes:[],children:[Text(\\\"To solve a system of 7 unknown variables, we need 7 independent equations. Luckily, we know what exactly 7 of the characters in our encrypted flag map to because of the standard flag format!\\\")])),Element((tag:Pre,attributes:[],children:[Element((tag:Code,attributes:[],children:[Text(\\\"encrypted: Ujyw5dnFofaou0au3nx3Cn84\\\\nformat:    DUCTF{.................}\\\\n\\\")]))])),Element((tag:P,attributes:[],children:[Text(\\\"Because the cipher is one-to-one, \\\"),Element((tag:Code,attributes:[],children:[Text(\\\"D\\\")])),Text(\\\" maps to \\\"),Element((tag:Code,attributes:[],children:[Text(\\\"U\\\")])),Text(\\\", \\\"),Element((tag:Code,attributes:[],children:[Text(\\\"U\\\")])),Text(\\\" maps to \\\"),Element((tag:Code,attributes:[],children:[Text(\\\"j\\\")])),Text(\\\", and so on. Based on the indices of these characters in \\\"),Element((tag:Code,attributes:[],children:[Text(\\\"CHARSET\\\")])),Text(\\\", we know that \\\"),Element((tag:Code,attributes:[],children:[Text(\\\"f(0) = 1\\\")])),Text(\\\", \\\"),Element((tag:Code,attributes:[],children:[Text(\\\"f(1) = 20\\\")])),Text(\\\"…\\\"),Text(\\\" \\\"),Element((tag:Code,attributes:[],children:[Text(\\\"f(6) = 41\\\")])),Text(\\\". We now have our 7 simultaneous equations:\\\")])),Element((tag:P,attributes:[],children:[Element((tag:Script,attributes:[(key:Type,value:\\\"math/tex\\\"),(key:Mode,value:\\\"display\\\")],children:[Text(\\\"\\\\n\\\\\\\\begin{align}\\\\n                                 g &=  1, \\\\\\\\\\\\\\\\\\\\n  a +   b +   c +  d +  e +  f + g &= 20, \\\\\\\\\\\\\\\\\\\\n64a + 32b + 16c + 8d + 4e + 2f + g &= 35, \\\\\\\\\\\\\\\\\\\\n&\\\\\\\\cdots\\\\n\\\\\\\\end{align}\\\\n\\\")]))])),Element((tag:P,attributes:[],children:[Text(\\\"We can create a matrix representation of these simultaneous equations, and now we need to solve for \\\"),Element((tag:Code,attributes:[],children:[Text(\\\"x\\\")])),Text(\\\":\\\")])),Element((tag:P,attributes:[],children:[Element((tag:Script,attributes:[(key:Type,value:\\\"math/tex\\\"),(key:Mode,value:\\\"display\\\")],children:[Text(\\\"\\\\n\\\\\\\\begin{bmatrix}\\\\n0 & 0 & 0 & 0 & 0 & 0 & 1 \\\\\\\\\\\\\\\\\\\\n1 & 1 & 1 & 1 & 1 & 1 & 1 \\\\\\\\\\\\\\\\\\\\n64 & 32 & 16 & 8 & 4 & 2 & 1 \\\\\\\\\\\\\\\\\\\\n& & & \\\\\\\\vdots & & &\\\\n\\\\\\\\end{bmatrix}\\\\nx =\\\\n\\\\\\\\begin{bmatrix}\\\\n1 \\\\\\\\\\\\\\\\ 20 \\\\\\\\\\\\\\\\ 35 \\\\\\\\\\\\\\\\ \\\\\\\\vdots\\\\n\\\\\\\\end{bmatrix}\\\\n\\\")]))])),Element((tag:P,attributes:[],children:[Text(\\\"Plugging the matrix and column vector into Maple and solving for \\\"),Element((tag:Code,attributes:[],children:[Text(\\\"x\\\")])),Text(\\\", \\\"),Element((tag:Code,attributes:[],children:[Text(\\\"x\\\")])),Text(\\\" is equal to the column vector \\\"),Element((tag:Code,attributes:[],children:[Text(\\\"\\u003c37/80, -633/80, 2437/48, -7229/48, 5963/30, -4349/60, 1>\\\")])),Text(\\\", which is equivalent to \\\"),Element((tag:Code,attributes:[],children:[Text(\\\"\\u003c41, 15, 40, 9, 28, 27, 1>\\\")])),Text(\\\" mod 47.\\\")])),Element((tag:P,attributes:[],children:[Text(\\\"Thus, our random polynomial, \\\"),Element((tag:Code,attributes:[],children:[Text(\\\"f\\\")])),Text(\\\", is \\\"),Element((tag:Script,attributes:[(key:Type,value:\\\"math/tex\\\")],children:[Text(\\\"41x^6 + 15x^5 + 40x^4 + 9x^3 + 28x^2 + 27x + 1\\\")])),Text(\\\".\\\")])),Element((tag:H2,attributes:[],children:[Text(\\\"Final solution:\\\")])),Element((tag:Pre,attributes:[],children:[Element((tag:Code,attributes:[],children:[Element((tag:Span,attributes:[(key:Style,value:\\\"color: rgb(180, 142, 173)\\\")],children:[Text(\\\"from\\\")])),Element((tag:Span,attributes:[(key:Style,value:\\\"color: rgb(192, 197, 206)\\\")],children:[Text(\\\" string \\\")])),Element((tag:Span,attributes:[(key:Style,value:\\\"color: rgb(180, 142, 173)\\\")],children:[Text(\\\"import\\\")])),Element((tag:Span,attributes:[(key:Style,value:\\\"color: rgb(192, 197, 206)\\\")],children:[Text(\\\" ascii_lowercase, digits\\\")])),Text(\\\"\\\\n\\\"),Text(\\\"\\\\n\\\"),Element((tag:Span,attributes:[(key:Style,value:\\\"color: rgb(191, 97, 106)\\\")],children:[Text(\\\"CHARSET\\\")])),Element((tag:Span,attributes:[(key:Style,value:\\\"color: rgb(192, 197, 206)\\\")],children:[Text(\\\" = \\\\\\\"\\\")])),Element((tag:Span,attributes:[(key:Style,value:\\\"color: rgb(163, 190, 140)\\\")],children:[Text(\\\"DUCTF\\\")])),Element((tag:Span,attributes:[(key:Style,value:\\\"color: rgb(208, 135, 112)\\\")],children:[Text(\\\"{}\\\")])),Element((tag:Span,attributes:[(key:Style,value:\\\"color: rgb(163, 190, 140)\\\")],children:[Text(\\\"_!?\\\\'\\\")])),Element((tag:Span,attributes:[(key:Style,value:\\\"color: rgb(192, 197, 206)\\\")],children:[Text(\\\"\\\\\\\" + ascii_lowercase + digits\\\")])),Text(\\\"\\\\n\\\"),Element((tag:Span,attributes:[(key:Style,value:\\\"color: rgb(101, 115, 126)\\\")],children:[Text(\\\"# Encrypted flag\\\")])),Text(\\\"\\\\n\\\"),Element((tag:Span,attributes:[(key:Style,value:\\\"color: rgb(191, 97, 106)\\\")],children:[Text(\\\"FLAG\\\")])),Element((tag:Span,attributes:[(key:Style,value:\\\"color: rgb(192, 197, 206)\\\")],children:[Text(\\\" = \\\\\\\"\\\")])),Element((tag:Span,attributes:[(key:Style,value:\\\"color: rgb(163, 190, 140)\\\")],children:[Text(\\\"Ujyw5dnFofaou0au3nx3Cn84\\\")])),Element((tag:Span,attributes:[(key:Style,value:\\\"color: rgb(192, 197, 206)\\\")],children:[Text(\\\"\\\\\\\"\\\")])),Text(\\\"\\\\n\\\"),Text(\\\"\\\\n\\\"),Element((tag:Span,attributes:[(key:Style,value:\\\"color: rgb(101, 115, 126)\\\")],children:[Text(\\\"# Given a number between 0 and 47, applies the random polynomial in Sage\\\")])),Text(\\\"\\\\n\\\"),Element((tag:Span,attributes:[(key:Style,value:\\\"color: rgb(101, 115, 126)\\\")],children:[Text(\\\"# to that number mod 47\\\")])),Text(\\\"\\\\n\\\"),Element((tag:Span,attributes:[(key:Style,value:\\\"color: rgb(180, 142, 173)\\\")],children:[Text(\\\"def\\\")])),Element((tag:Span,attributes:[(key:Style,value:\\\"color: rgb(192, 197, 206)\\\")],children:[Text(\\\" \\\")])),Element((tag:Span,attributes:[(key:Style,value:\\\"color: rgb(143, 161, 179)\\\")],children:[Text(\\\"polynomial_g47\\\")])),Element((tag:Span,attributes:[(key:Style,value:\\\"color: rgb(192, 197, 206)\\\")],children:[Text(\\\"(\\\")])),Element((tag:Span,attributes:[(key:Style,value:\\\"color: rgb(191, 97, 106)\\\")],children:[Text(\\\"x\\\")])),Element((tag:Span,attributes:[(key:Style,value:\\\"color: rgb(192, 197, 206)\\\")],children:[Text(\\\"):\\\")])),Text(\\\"\\\\n\\\"),Element((tag:Span,attributes:[(key:Style,value:\\\"color: rgb(192, 197, 206)\\\")],children:[Text(\\\"    poly = \\\")])),Element((tag:Span,attributes:[(key:Style,value:\\\"color: rgb(208, 135, 112)\\\")],children:[Text(\\\"41\\\")])),Element((tag:Span,attributes:[(key:Style,value:\\\"color: rgb(192, 197, 206)\\\")],children:[Text(\\\" * x ** \\\")])),Element((tag:Span,attributes:[(key:Style,value:\\\"color: rgb(208, 135, 112)\\\")],children:[Text(\\\"6\\\")])),Element((tag:Span,attributes:[(key:Style,value:\\\"color: rgb(192, 197, 206)\\\")],children:[Text(\\\" + \\\")])),Element((tag:Span,attributes:[(key:Style,value:\\\"color: rgb(208, 135, 112)\\\")],children:[Text(\\\"15\\\")])),Element((tag:Span,attributes:[(key:Style,value:\\\"color: rgb(192, 197, 206)\\\")],children:[Text(\\\" * x ** \\\")])),Element((tag:Span,attributes:[(key:Style,value:\\\"color: rgb(208, 135, 112)\\\")],children:[Text(\\\"5\\\")])),Element((tag:Span,attributes:[(key:Style,value:\\\"color: rgb(192, 197, 206)\\\")],children:[Text(\\\" + \\\")])),Element((tag:Span,attributes:[(key:Style,value:\\\"color: rgb(208, 135, 112)\\\")],children:[Text(\\\"40\\\")])),Element((tag:Span,attributes:[(key:Style,value:\\\"color: rgb(192, 197, 206)\\\")],children:[Text(\\\" * x ** \\\")])),Element((tag:Span,attributes:[(key:Style,value:\\\"color: rgb(208, 135, 112)\\\")],children:[Text(\\\"4\\\")])),Element((tag:Span,attributes:[(key:Style,value:\\\"color: rgb(192, 197, 206)\\\")],children:[Text(\\\" + \\\")])),Element((tag:Span,attributes:[(key:Style,value:\\\"color: rgb(208, 135, 112)\\\")],children:[Text(\\\"9\\\")])),Element((tag:Span,attributes:[(key:Style,value:\\\"color: rgb(192, 197, 206)\\\")],children:[Text(\\\" * x ** \\\")])),Element((tag:Span,attributes:[(key:Style,value:\\\"color: rgb(208, 135, 112)\\\")],children:[Text(\\\"3\\\")])),Element((tag:Span,attributes:[(key:Style,value:\\\"color: rgb(192, 197, 206)\\\")],children:[Text(\\\" + \\\")])),Element((tag:Span,attributes:[(key:Style,value:\\\"color: rgb(208, 135, 112)\\\")],children:[Text(\\\"28\\\")])),Element((tag:Span,attributes:[(key:Style,value:\\\"color: rgb(192, 197, 206)\\\")],children:[Text(\\\" * x ** \\\")])),Element((tag:Span,attributes:[(key:Style,value:\\\"color: rgb(208, 135, 112)\\\")],children:[Text(\\\"2\\\")])),Element((tag:Span,attributes:[(key:Style,value:\\\"color: rgb(192, 197, 206)\\\")],children:[Text(\\\" + \\\")])),Element((tag:Span,attributes:[(key:Style,value:\\\"color: rgb(208, 135, 112)\\\")],children:[Text(\\\"27\\\")])),Element((tag:Span,attributes:[(key:Style,value:\\\"color: rgb(192, 197, 206)\\\")],children:[Text(\\\" * x + \\\")])),Element((tag:Span,attributes:[(key:Style,value:\\\"color: rgb(208, 135, 112)\\\")],children:[Text(\\\"1\\\")])),Text(\\\"\\\\n\\\"),Element((tag:Span,attributes:[(key:Style,value:\\\"color: rgb(192, 197, 206)\\\")],children:[Text(\\\"    \\\")])),Element((tag:Span,attributes:[(key:Style,value:\\\"color: rgb(180, 142, 173)\\\")],children:[Text(\\\"return\\\")])),Element((tag:Span,attributes:[(key:Style,value:\\\"color: rgb(192, 197, 206)\\\")],children:[Text(\\\" poly % \\\")])),Element((tag:Span,attributes:[(key:Style,value:\\\"color: rgb(208, 135, 112)\\\")],children:[Text(\\\"47\\\")])),Text(\\\"\\\\n\\\"),Text(\\\"\\\\n\\\"),Element((tag:Span,attributes:[(key:Style,value:\\\"color: rgb(101, 115, 126)\\\")],children:[Text(\\\"# Maps each possible input character (D, U, C, T, F and so on) to\\\")])),Text(\\\"\\\\n\\\"),Element((tag:Span,attributes:[(key:Style,value:\\\"color: rgb(101, 115, 126)\\\")],children:[Text(\\\"# a list of characters it might be translated from, so mapping[1] = \\\\\\\"D\\\\\\\"\\\")])),Text(\\\"\\\\n\\\"),Element((tag:Span,attributes:[(key:Style,value:\\\"color: rgb(192, 197, 206)\\\")],children:[Text(\\\"mapping = [\\\\\\\"\\\\\\\"] * \\\")])),Element((tag:Span,attributes:[(key:Style,value:\\\"color: rgb(208, 135, 112)\\\")],children:[Text(\\\"47\\\")])),Text(\\\"\\\\n\\\"),Element((tag:Span,attributes:[(key:Style,value:\\\"color: rgb(180, 142, 173)\\\")],children:[Text(\\\"for\\\")])),Element((tag:Span,attributes:[(key:Style,value:\\\"color: rgb(192, 197, 206)\\\")],children:[Text(\\\" i \\\")])),Element((tag:Span,attributes:[(key:Style,value:\\\"color: rgb(180, 142, 173)\\\")],children:[Text(\\\"in\\\")])),Element((tag:Span,attributes:[(key:Style,value:\\\"color: rgb(192, 197, 206)\\\")],children:[Text(\\\" \\\")])),Element((tag:Span,attributes:[(key:Style,value:\\\"color: rgb(150, 181, 180)\\\")],children:[Text(\\\"range\\\")])),Element((tag:Span,attributes:[(key:Style,value:\\\"color: rgb(192, 197, 206)\\\")],children:[Text(\\\"(\\\")])),Element((tag:Span,attributes:[(key:Style,value:\\\"color: rgb(208, 135, 112)\\\")],children:[Text(\\\"47\\\")])),Element((tag:Span,attributes:[(key:Style,value:\\\"color: rgb(192, 197, 206)\\\")],children:[Text(\\\"):\\\")])),Text(\\\"\\\\n\\\"),Element((tag:Span,attributes:[(key:Style,value:\\\"color: rgb(192, 197, 206)\\\")],children:[Text(\\\"    mapping[\\\")])),Element((tag:Span,attributes:[(key:Style,value:\\\"color: rgb(143, 161, 179)\\\")],children:[Text(\\\"polynomial_g47\\\")])),Element((tag:Span,attributes:[(key:Style,value:\\\"color: rgb(192, 197, 206)\\\")],children:[Text(\\\"(i)] += \\\")])),Element((tag:Span,attributes:[(key:Style,value:\\\"color: rgb(191, 97, 106)\\\")],children:[Text(\\\"CHARSET\\\")])),Element((tag:Span,attributes:[(key:Style,value:\\\"color: rgb(192, 197, 206)\\\")],children:[Text(\\\"[i]\\\")])),Text(\\\"\\\\n\\\"),Text(\\\"\\\\n\\\"),Element((tag:Span,attributes:[(key:Style,value:\\\"color: rgb(150, 181, 180)\\\")],children:[Text(\\\"print\\\")])),Element((tag:Span,attributes:[(key:Style,value:\\\"color: rgb(192, 197, 206)\\\")],children:[Text(\\\"(mapping)\\\")])),Text(\\\"\\\\n\\\"),Text(\\\"\\\\n\\\"),Element((tag:Span,attributes:[(key:Style,value:\\\"color: rgb(101, 115, 126)\\\")],children:[Text(\\\"# Prints out all possible combinations of characters that\\\")])),Text(\\\"\\\\n\\\"),Element((tag:Span,attributes:[(key:Style,value:\\\"color: rgb(101, 115, 126)\\\")],children:[Text(\\\"# form the encrypted flag\\\")])),Text(\\\"\\\\n\\\"),Element((tag:Span,attributes:[(key:Style,value:\\\"color: rgb(192, 197, 206)\\\")],children:[Text(\\\"result = \\\\\\\"\\\\\\\"\\\")])),Text(\\\"\\\\n\\\"),Element((tag:Span,attributes:[(key:Style,value:\\\"color: rgb(180, 142, 173)\\\")],children:[Text(\\\"for\\\")])),Element((tag:Span,attributes:[(key:Style,value:\\\"color: rgb(192, 197, 206)\\\")],children:[Text(\\\" char \\\")])),Element((tag:Span,attributes:[(key:Style,value:\\\"color: rgb(180, 142, 173)\\\")],children:[Text(\\\"in\\\")])),Element((tag:Span,attributes:[(key:Style,value:\\\"color: rgb(192, 197, 206)\\\")],children:[Text(\\\" \\\")])),Element((tag:Span,attributes:[(key:Style,value:\\\"color: rgb(191, 97, 106)\\\")],children:[Text(\\\"FLAG\\\")])),Element((tag:Span,attributes:[(key:Style,value:\\\"color: rgb(192, 197, 206)\\\")],children:[Text(\\\":\\\")])),Text(\\\"\\\\n\\\"),Element((tag:Span,attributes:[(key:Style,value:\\\"color: rgb(192, 197, 206)\\\")],children:[Text(\\\"    index = CHARSET.\\\")])),Element((tag:Span,attributes:[(key:Style,value:\\\"color: rgb(143, 161, 179)\\\")],children:[Text(\\\"index\\\")])),Element((tag:Span,attributes:[(key:Style,value:\\\"color: rgb(192, 197, 206)\\\")],children:[Text(\\\"(char)\\\")])),Text(\\\"\\\\n\\\"),Element((tag:Span,attributes:[(key:Style,value:\\\"color: rgb(192, 197, 206)\\\")],children:[Text(\\\"    current = mapping[index]\\\")])),Text(\\\"\\\\n\\\"),Text(\\\"\\\\n\\\"),Element((tag:Span,attributes:[(key:Style,value:\\\"color: rgb(192, 197, 206)\\\")],children:[Text(\\\"    \\\")])),Element((tag:Span,attributes:[(key:Style,value:\\\"color: rgb(180, 142, 173)\\\")],children:[Text(\\\"if\\\")])),Element((tag:Span,attributes:[(key:Style,value:\\\"color: rgb(192, 197, 206)\\\")],children:[Text(\\\" \\\")])),Element((tag:Span,attributes:[(key:Style,value:\\\"color: rgb(150, 181, 180)\\\")],children:[Text(\\\"len\\\")])),Element((tag:Span,attributes:[(key:Style,value:\\\"color: rgb(192, 197, 206)\\\")],children:[Text(\\\"(current) > \\\")])),Element((tag:Span,attributes:[(key:Style,value:\\\"color: rgb(208, 135, 112)\\\")],children:[Text(\\\"1\\\")])),Element((tag:Span,attributes:[(key:Style,value:\\\"color: rgb(192, 197, 206)\\\")],children:[Text(\\\":\\\")])),Text(\\\"\\\\n\\\"),Element((tag:Span,attributes:[(key:Style,value:\\\"color: rgb(192, 197, 206)\\\")],children:[Text(\\\"        result += \\\")])),Element((tag:Span,attributes:[(key:Style,value:\\\"color: rgb(180, 142, 173)\\\")],children:[Text(\\\"f\\\")])),Element((tag:Span,attributes:[(key:Style,value:\\\"color: rgb(192, 197, 206)\\\")],children:[Text(\\\"\\\\\\\"\\\")])),Element((tag:Span,attributes:[(key:Style,value:\\\"color: rgb(163, 190, 140)\\\")],children:[Text(\\\"[\\\")])),Element((tag:Span,attributes:[(key:Style,value:\\\"color: rgb(192, 197, 206)\\\")],children:[Text(\\\"{current}\\\")])),Element((tag:Span,attributes:[(key:Style,value:\\\"color: rgb(163, 190, 140)\\\")],children:[Text(\\\"]\\\")])),Element((tag:Span,attributes:[(key:Style,value:\\\"color: rgb(192, 197, 206)\\\")],children:[Text(\\\"\\\\\\\"\\\")])),Text(\\\"\\\\n\\\"),Element((tag:Span,attributes:[(key:Style,value:\\\"color: rgb(192, 197, 206)\\\")],children:[Text(\\\"    \\\")])),Element((tag:Span,attributes:[(key:Style,value:\\\"color: rgb(180, 142, 173)\\\")],children:[Text(\\\"else\\\")])),Element((tag:Span,attributes:[(key:Style,value:\\\"color: rgb(192, 197, 206)\\\")],children:[Text(\\\":\\\")])),Text(\\\"\\\\n\\\"),Element((tag:Span,attributes:[(key:Style,value:\\\"color: rgb(192, 197, 206)\\\")],children:[Text(\\\"        result += current\\\")])),Text(\\\"\\\\n\\\"),Text(\\\"\\\\n\\\"),Element((tag:Span,attributes:[(key:Style,value:\\\"color: rgb(150, 181, 180)\\\")],children:[Text(\\\"print\\\")])),Element((tag:Span,attributes:[(key:Style,value:\\\"color: rgb(192, 197, 206)\\\")],children:[Text(\\\"(result)\\\")])),Text(\\\"\\\\n\\\")]))])),Element((tag:P,attributes:[],children:[Text(\\\"Running this program returns the output \\\"),Element((tag:Code,attributes:[],children:[Text(\\\"D[U!]C[Tt]F{go0d_0l\\\\'_l4gr4[fnp]g[38]}\\\")])),Text(\\\".\\\"),Text(\\\"\\\\n\\\"),Text(\\\"Choosing the right characters in each square bracket, we get the flag\\\"),Text(\\\"\\\\n\\\"),Element((tag:Code,attributes:[],children:[Text(\\\"DUCTF{go0d_0l\\\\'_l4gr4ng3}\\\")])),Text(\\\".\\\")]))]\"}";</script><script nonce="E5CouHtUasC6QndkGblOrg">__INCOMPLETE_CHUNKS=[];</script>